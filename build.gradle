plugins {
  //inlude the nodeJS plugin to execute nodejs and npm tasks
  id "com.github.node-gradle.node" version "3.0.1"
}

node {
	download = true
    	version = "16.20.0" // Update to a recent LTS version of NodeJS
    	npmVersion = "8.19.4" // Update to a recent compatible version of NPM
}

//declare a build task
tasks.register('build') {
    // Define build logic if needed
}

tasks.register('zip', Zip) {
    from('.') {
        include "*"
        include "bin/**"
        include "data/**"
        include "node_modules/**"
        include "public/**"
        include "routes/**"
        include "views/**"
    }
    destinationDirectory.set(file("dist"))
    archiveBaseName.set("trainSchedule")
}

// Define task dependencies
tasks.named('build') {
    dependsOn tasks.named('zip')
}

tasks.named('zip') {
    dependsOn tasks.named('npm_build')
}

tasks.named('npm_build') {
    dependsOn tasks.named('npm_test')
}

tasks.named('npm_test') {
    dependsOn tasks.named('npmInstall')
}
